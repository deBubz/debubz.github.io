<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Second sprint | Bao Hoang</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.3.1">
    
    
    <link rel="preload" href="/assets/css/0.styles.b4740cec.css" as="style"><link rel="preload" href="/assets/js/app.bb4800e2.js" as="script"><link rel="preload" href="/assets/js/2.afad7853.js" as="script"><link rel="preload" href="/assets/js/4.310bafcb.js" as="script"><link rel="prefetch" href="/assets/js/10.8f1278d6.js"><link rel="prefetch" href="/assets/js/11.59fed7ea.js"><link rel="prefetch" href="/assets/js/3.0eda6790.js"><link rel="prefetch" href="/assets/js/5.5e611a6b.js"><link rel="prefetch" href="/assets/js/6.09b78c89.js"><link rel="prefetch" href="/assets/js/7.bec44c57.js"><link rel="prefetch" href="/assets/js/8.91bfa9ac.js"><link rel="prefetch" href="/assets/js/9.c18a08fe.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b4740cec.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Bao Hoang</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Summer IoT Studio</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summer/" class="sidebar-link">What's this?</a></li><li><a href="/summer/sprint1.html" class="sidebar-link">1st Sprint</a></li><li><a href="/summer/sprint2.html" class="active sidebar-link">2nd Sprint</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/summer/sprint2.html#week-plan" class="sidebar-link">Week plan</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/summer/sprint2.html#day-1-catch-up" class="sidebar-link">Day 1 - Catch-up</a></li><li class="sidebar-sub-header"><a href="/summer/sprint2.html#day-2-database" class="sidebar-link">Day 2 - Database</a></li><li class="sidebar-sub-header"><a href="/summer/sprint2.html#day-3-proof-of-concept" class="sidebar-link">Day 3 - Proof of concept</a></li><li class="sidebar-sub-header"><a href="/summer/sprint2.html#day-4-improving-the-poc" class="sidebar-link">Day 4 - Improving the PoC</a></li><li class="sidebar-sub-header"><a href="/summer/sprint2.html#day-5-c" class="sidebar-link">Day 5 - c++</a></li></ul></li><li class="sidebar-sub-header"><a href="/summer/sprint2.html#evaluation" class="sidebar-link">Evaluation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/summer/sprint2.html#plan-for-next-sprint" class="sidebar-link">Plan for next sprint</a></li></ul></li></ul></li><li><a href="/summer/sprint3.html" class="sidebar-link">3rd Sprint</a></li><li><a href="/summer/sprint4.html" class="sidebar-link">Final Sprint</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="second-sprint"><a href="#second-sprint" class="header-anchor">#</a> Second sprint</h1> <h2 id="week-plan"><a href="#week-plan" class="header-anchor">#</a> Week plan</h2> <p>To improve from last week, I approached this week with more <strong>thought and planning</strong> into my tasks this week.
Spending some time at the end of each days to plan some task for the next day,
and at the start of each day, break down those tasks to smaller, and more detailed objectives to be completed through out the day.</p> <h3 id="day-1-catch-up"><a href="#day-1-catch-up" class="header-anchor">#</a> Day 1 - Catch-up</h3> <h4 id="proof-of-concept-using-the-bh170-light-sensor"><a href="#proof-of-concept-using-the-bh170-light-sensor" class="header-anchor">#</a> Proof of Concept (using the <code>bh170</code> light sensor)</h4> <p>Part of the day is spent trying to build a simple <strong>Proof Of Concept</strong> that would gather data and send it through the <code>mqtt</code> broker, using a more accurate &quot;<a href="https://www.mysensors.org/build/light-bh1750" target="_blank" rel="noopener noreferrer">ambient light intensity sensor <code>bh1750</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>&quot;.
The construction and programming was rather simple with this sensor.
When connected with the DataLogger like the image below, the <a href="https://github.com/claws/BH1750/blob/master/examples/BH1750test/BH1750test.ino" target="_blank" rel="noopener noreferrer">example code<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> from the <a href="https://platformio.org/lib/show/439/BH1750" target="_blank" rel="noopener noreferrer"><code>bh1750</code> library<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> worked immediately with out configuration.</p> <p><img src="/assets/img/s2_d1_loger.f46ab6d1.png" alt="Modded DataLogger"></p> <h4 id="overall-iot-framework"><a href="#overall-iot-framework" class="header-anchor">#</a> Overall IoT Framework</h4> <p>I also <strong>collaborated</strong> with my team and work on the general architecture for our IoT System.
Even though each members are working on different problems, working together to build a <strong>common architecture</strong> allow us to have more time to improve our own projects.
We agreed on this model.</p> <p><img src="/assets/img/s2_d1_model.bc62c17f.png" alt="Architecture Model"></p> <p>According from this model, from the top down.
The client will be able to control the devices using an <code>API</code>.
All and any recorded data is received through the <code>MQTT broker</code> and stored in a database.
Which then could be presented to the clients for analysis with the <code>API</code>.</p> <p>Seeing the agreed on model is very similar to <a href="/summer/#solution">my own idea</a> for the architecture. I glad to see that I was on the right track.</p> <h4 id="data-visualizer"><a href="#data-visualizer" class="header-anchor">#</a> Data Visualizer</h4> <p>Having database already setup by teammate, I set up a data base visualizer called <a href="https://www.metabase.com/" target="_blank" rel="noopener noreferrer">Metabase<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, recommended by Danon, on another server.
All it needs to do is to attach a db to work.</p> <h3 id="day-2-database"><a href="#day-2-database" class="header-anchor">#</a> Day 2 - Database</h3> <h4 id="relational-v-non-relational"><a href="#relational-v-non-relational" class="header-anchor">#</a> Relational v Non-Relational</h4> <p>Having past experience with <em>relational</em> databases(<code>mysql</code>, <code>sqlite</code>), I want to better understand the <strong>Non-Relational database</strong>, <code>MongoDb</code> my team is using to store sensor data.</p> <table><thead><tr><th>Relational</th> <th>Non-Relational</th></tr></thead> <tbody><tr><td>Fixed format: requires to define a <strong>schema</strong>, better data integrity</td> <td>More <strong>flexible structure</strong>, better for data that changed frequently</td></tr> <tr><td>Data relation: better at <strong>linking</strong> related data</td> <td>In MongoDb, data is recorded as <strong>separated</strong>, unrelated documents</td></tr></tbody></table> <blockquote><p><strong>Sources</strong></p> <ul><li><a href="https://docs.mongodb.com/manual/" target="_blank" rel="noopener noreferrer"><code>MongoDB</code> documentation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://youtu.be/uD3p_rZPBUQ" target="_blank" rel="noopener noreferrer">Intro to NoSql<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://youtu.be/ZS_kXvOeQ5Y" target="_blank" rel="noopener noreferrer">SQL v NoSQL or MySQL v MongoDB<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></blockquote> <h4 id="mongodb"><a href="#mongodb" class="header-anchor">#</a> MongoDb</h4> <p>Also as a part of my learning contract to learn new and different tools, I planned the day to focus on learning <code>MongoDb</code>.
I went through some videos, made some notes on the <a href="">syntaxes</a>(<code>mongodb</code> queries are much simpler than <code>SQL</code> queries). Then deployed, my own MongoDb on another <code>Vultr</code> Server using this <a href="https://www.digitalocean.com/community/tutorials/how-to-install-mongodb-on-ubuntu-18-04" target="_blank" rel="noopener noreferrer">guide<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>The only thing left to do is to <strong>build</strong> a <code>Node</code> Application which insert published data from the MQTT into the database.</p> <p><strong>NOTE</strong>: This part of the architecture was already implemented by another member of my group on the &quot;turtle&quot; server. The decision to learn <code>MongoDb</code> is out of my own interest and to fulfill my <a href="/summer/#learning-contract">learning contract</a> for this Studio.</p> <h3 id="day-3-proof-of-concept"><a href="#day-3-proof-of-concept" class="header-anchor">#</a> Day 3 - Proof of concept</h3> <h4 id="messaging-protocol"><a href="#messaging-protocol" class="header-anchor">#</a> Messaging Protocol</h4> <p>Due to the limitation of the <a href="https://github.com/knolleary/pubsubclient" target="_blank" rel="noopener noreferrer"><code>PubSubClient</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>'s payload publication(<code>128 bytes</code> per payload).
My Team has to change the initial plan of sending data in the format of a <code>JSON</code> object into a <code>string</code> to better fit that restriction.
My team had agreed upon a sending a payload in the format of a string consist of <strong>12 characters</strong>(generally alphanumerical chars are <strong>1 byte</strong> each).
The server will then set up to splice up the string into separate categories and stored as a document in the DB.</p> <div class="language-md extra-class"><pre class="language-md"><code>Example Payload: <span class="token code keyword">`ab0000cdxxx`</span>

- <span class="token code keyword">`a`</span>    = deviceID         [a-zA-Z0-9]
- <span class="token code keyword">`b`</span>    = topic            [a-zA-Z]
- <span class="token code keyword">`0000`</span> = timestamp        4[0-9]
- <span class="token code keyword">`c`</span>    = sensorID         [a-zA-Z0-9]
- <span class="token code keyword">`d`</span>    = senorType        [a-zA-Z]
- <span class="token code keyword">`xxx`</span>  = sensor reading   3[0-9.]
</code></pre></div><h4 id="prototype"><a href="#prototype" class="header-anchor">#</a> Prototype</h4> <p>I received and used a <a href="https://www.nodemcu.com/index_en.html" target="_blank" rel="noopener noreferrer">NodeMCU<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to build a simpler and more compact device(as seen below) comparatively to the device in <a href="#day-1-catch-up">day 1</a> of this sprint.</p> <p><img src="/assets/img/s2_d3_node.9a9e41b9.jpg" alt="Better Prototype"></p> <h4 id="using-metabase"><a href="#using-metabase" class="header-anchor">#</a> Using Metabase</h4> <p>With my device publishing data into the <em>&quot;turtle&quot;</em> db using the new protocol. My team linked the database to <strong>Metabase</strong> I set up on Monday and produced this graph with some sample generated data from the <code>bh1750</code> sensor.</p> <p><img src="/assets/img/s2_d3_graph.75e2a413.png" alt="Metabase Test"></p> <h3 id="day-4-improving-the-poc"><a href="#day-4-improving-the-poc" class="header-anchor">#</a> Day 4 - Improving the PoC</h3> <p>With Most of the <strong>basic functionalities</strong> done, I spent the day thinking about how I could further <strong>improve</strong> my solution's Proof of Concept</p> <h4 id="large-scale-design"><a href="#large-scale-design" class="header-anchor">#</a> Large scale Design</h4> <p>Thinking about if my device would have been implemented in a <strong>large city</strong> using <a href="https://www.essentialenergy.com.au/our-network/streetlights" target="_blank" rel="noopener noreferrer">this doc<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> as a reference, these are issues which needs to be address.</p> <ul><li>A difficult issue would by how data is transmitted. The current design is built with assumption that a <code>wifi</code> connection is <strong>available everywhere</strong>.</li> <li>Power is another realistic issue. There are 2 ways of approaching this:
<ul><li>One is to modify current light poles to house the device and use the pole's power, but that would be rather <strong>expensive to replace</strong> the current infrastructure.</li> <li>Another method is to build the device as an attachment to a light pole, powered by <strong>its own power supply</strong>.</li></ul></li> <li>With how the device functions, notifies the responsible organizations for street lights when they are non-functional and keep data on the bulb's life span. It is not necessary to continuously record the data. This should further help <strong>increase the lifespan</strong> if the device is built with its own power supply</li></ul> <h4 id="iot-datalogger-comparison"><a href="#iot-datalogger-comparison" class="header-anchor">#</a> IoT DataLogger comparison</h4> <p>I also used the <strong>IoT Datalogger</strong> as a model to further improve my PoC. Especially how it averages data from the <strong>accelerometer</strong> to be more accurate for situations where there would be a <strong>rapid change/spike</strong> in the data.</p> <p>The data logger would collect a number amount of entries over 3 seconds, averaging it into <strong>10 separate payload</strong>, then send all of them at the end of the 3 seconds.</p> <p>I would like to also implement this feature with different numbers. How it works can be seen below</p> <p><img src="/assets/img/s2_d4_model.c7e229b4.jpg" alt="Payloads"></p> <h3 id="day-5-c"><a href="#day-5-c" class="header-anchor">#</a> Day 5 - c++</h3> <p>I spent Friday to have a closer look at the code of the device.
Specifically how <strong>header files</strong> of <code>C++</code> works to better <strong>refactor</strong> the code.
This is also be my first time working with <strong>C++</strong>, so seeing that you need to declare functions/methods in 2 separate files <code>FileName.h</code> and <code>FileName.cpp</code> is kind of strange.
I guess it is similar to <strong>inheritance</strong>?</p> <p>Going through video such as <a href="https://youtu.be/9RJTQmK0YPI" target="_blank" rel="noopener noreferrer">this<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, and started with a simple command to print something on the Serial console</p> <p><img src="/assets/img/s2_d5_serial.c6b64001.png" alt="Header files"></p> <p>From there, I moved on to try to implement the data averaging function similar to the DataLogger (albeit my code is pretty <code>hacky</code> ehehe)</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">void</span> LightSensorClass<span class="token operator">::</span><span class="token function">BHPayloadReadings</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> a<span class="token punctuation">)</span><span class="token punctuation">{</span> 
    <span class="token comment">//float readings[5]; // .5 sec</span>
    <span class="token keyword">float</span> PLTotal <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">float</span> PLAverage<span class="token punctuation">;</span>
    
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        PLTotal <span class="token operator">+=</span> <span class="token function">BHReadings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// nice one </span>
        <span class="token comment">// theres better ways to do this</span>
        Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token function">BHReadings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot; added in = &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>PLTotal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// .1 sec</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>But then there is <strong>a bug</strong> during the runtime of the device, the recorded data per payload would be <strong>all identical</strong>.
From a small consultation with a peer, It has something to do with this code block in the <code>loop()</code> as seen below. I don't exactly understand how it works yet. I guess, brute force does not work.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">long</span> now <span class="token operator">=</span> <span class="token function">millis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>now <span class="token operator">-</span> lastMsg <span class="token operator">&gt;</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    lastMsg <span class="token operator">=</span> now<span class="token punctuation">;</span>
    value<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="evaluation"><a href="#evaluation" class="header-anchor">#</a> Evaluation</h2> <p>I can say with a little planning, this sprint was less overwhelming and stressful than the previous sprint.
I also think, I successfully achieved more and learned more when a target goal is set.</p> <p>Moving on from this, I need to better <strong>prioritize</strong> what I need to do to complete the solution.
At the moment, the bare bone and basic functionalities of the IoT framework is done.
All that left to do is to build an interface to complete the framework. Beside from that, I need to better refine the device quite a bit to better solve my problem.</p> <h3 id="plan-for-next-sprint"><a href="#plan-for-next-sprint" class="header-anchor">#</a> Plan for next sprint</h3> <ul><li>Building an <strong>interface</strong>, with the goal for the user to see the status of each street light, and see the performance trend of that street light.</li> <li>Add a <strong>power supply</strong> for the device, configure it to be active in a certain time, and only collect data once every x time to further extend the battery life</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/summer/sprint1.html" class="prev">
        1st Sprint
      </a></span> <span class="next"><a href="/summer/sprint3.html">
        3rd Sprint
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.bb4800e2.js" defer></script><script src="/assets/js/2.afad7853.js" defer></script><script src="/assets/js/4.310bafcb.js" defer></script>
  </body>
</html>
